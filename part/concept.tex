\section{Концепция безопасности БД}
С развитием технологий архитектура программного и аппаратного обеспечения становится только сложнее, что приводит к росту числа их критических уязвимостей. Аналитики компании Embroker прогнозируют, что в период с 2022 по 2025 год бюджеты компаний на информационную безопасность вырастут сразу на 70\%. Это свидетельствует о необходимости усиления мер по защите данных, особенно в контексте увеличивающегося государственного контроля и постоянных новостей о крупных утечках данных \autocite{DataProtectionMaterials}.
Системы управления базами данных (СУБД), в особенности реляционные СУБД и экспертные системы (ЭС), стали доминирующим инструментом в области хранения, обработки и представления данных. Поэтому защита данных от несанкционированного доступа, от несанкционированной модификации или просто от их разрушения является одной из приоритетных задач при проектировании любой информационной системы. Эта проблема (проблема защиты данных) охватывает как физическую защиту данных и системных программ, так и защиту от несанкционированного доступа к данным, передаваемым по линиям связи и находящимся на накопителях, являющегося результатом деятельности как посторонних лиц, так и специальных программ вирусов \autocite[с. 6]{Skakun}.
В этой главе мы рассмотрим основные аспекты безопасности баз данных (БД): какие существуют угрозы для БД, требования по безопасности БД, способы защиты от несанкционированного доступа, защиты от вывода, что означает целостность БД, аудит, многоуровневая защита, какие существуют типы контроля безопасности.

\subsection{Понятие безопасности БД}

\begin{grayquote}
	\textbf{База данных} -- это упорядоченный набор структурированной информации или данных, которые обычно хранятся в электронном виде в компьютерной системе. База данных обычно управляется системой управления базами данных (СУБД). Данные вместе с СУБД, а также приложения, которые с ними связаны, называются системой баз данных, или, для краткости, просто базой данных \autocite{oracleWhatIsDatabase}.
\end{grayquote}


\begin{grayquote}
	Согласно \autocite{CCRFPart4}, базой данных является представленная в объективной форме совокупность самостоятельных материалов (статей, расчетов, нормативных актов, судебных решений и иных подобных материалов), систематизированных таким образом, чтобы эти материалы могли быть найдены и обработаны с помощью электронной вычислительной машины (ЭВМ).
\end{grayquote}

При формулировке основных понятий и определений будем полагать, что защищаемым объектом является не сама БД или экспертная система, а компьютерная система (КС) в целом. Понятие защиты применимо не только к сохраняемым данным. Бреши в системе защиты могут возникать и в других частях системы, например, линии связи, что в свою очередь, подвергает опасности и собственно БД. Следовательно, защита БД должна охватывать используемое оборудование, программное обеспечение, персонал и собственно данные \autocite[сс. 15-18]{Skakun}. 

Информационная безопасность – состояние рассматриваемой КС, при которой она, с одной стороны, способна противостоять дестабилизирующему воздействию внешних и внутренних информационных угроз, а с другой – функционирование системы и сам факт ее наличия не создают угроз для ее пользователей, для внешней среды и для элементов самой КС \autocite[сс. 15-18]{Skakun}.

Защита информации - комплекс мероприятий, направленных на обеспечение информационной безопасности (целостности, доступности, конфиденциальности) \autocite[сс. 15-18]{Skakun}.

Защищаемая информация – информация, являющаяся предметом собственности и подлежащая защите в соответствии с требованиями правовых документов или требованиями, устанавливаемыми собственником информации \autocite[сс. 15-18]{Skakun}.

Защищаемая информационная система – система, предназначенная для обработки защищаемой информации с требуемым уровнем ее защищенности \autocite[сс. 15-18]{Skakun}.

Система называется безопасной, если она управляет доступом к информации так, что только должным образом авторизованные лица или же действующие от их имени процессы получают право читать, писать, создавать и удалять информацию \autocite[сс. 15-18]{Skakun}. 

Система считается доверенной, если она с использованием достаточных аппаратных и программных средств обеспечивает одновременную обработку информации разной степени секретности группой пользователей без нарушения прав доступа \autocite[сс. 15-18]{Skakun}.

Основными критериями оценки надежности являются политика безопасности и гарантированность \autocite[сс. 15-18]{Skakun}.

Политикой безопасности называют качественное описание комплекса организационно-технологических и программнотехнических мер по обеспечению защиты данных в КС, включает в себя анализ возможных угроз и выбор соответствующих мер противодействия. Выбор конкретных механизмов обеспечения безопасности системы производится в соответствии с политикой безопасности \autocite[сс. 15-18]{Skakun}.

Гарантированность - это пассивный элемент защиты, который отображает меру доверия, которая может быть оказана архитектуре и реализации системы. Гарантированность можно определить тестированием системы в целом и отдельных ее компонентов.

Для управления доступом к данным и обеспечения этих свойств используются следующие фундаментальные понятия:

\textbf{Субъект доступа} — это активный компонент системы (пользователь, процесс), который может стать причиной инициализации потока информации или изменения состояния системы \autocite[сс. 15-18]{Skakun}. 

\textbf{Объект доступа} — это пассивный компонент системы, хранящий, принимающий или передающий информацию. В БД объектами может быть все, от целой таблицы до отдельного поля \autocite[сс. 15-18]{Skakun}.

Взаимодействие между субъектами и объектами регулируется через процессы идентификации, аутентификации и авторизации:
\begin{itemize}
    \item \textbf{Идентификация} - присвоение объектам и субъектам доступа уникального идентификатора \autocite[сс. 15-18]{Skakun}.
    \item \textbf{Аутентификация}  - проверка принадлежности субъекту доступа предъявленного им идентификатора, то есть подтверждение подлинности \autocite[сс. 15-18]{Skakun}.
    \item \textbf{Авторизация} - это предоставление прав (или привилегий), позволяющих субъекту иметь законный доступ к объектам системы после успешной аутентификации \autocite[сс. 15-18]{Skakun}.
\end{itemize}

Правила разграничения доступа - совокупность правил, регламентирующих права субъектов доступа к объектам доступа. Контроль доступа обязательно включает идентификацию и аутентификацию всех субъектов и их процессов и разграничение полномочий субъектов по отношению к объектам с последующей обязательной проверкой введенных полномочий \autocite[сс. 15-18]{Skakun}.

Привилегия доступа - совокупность прав доступа субъекта доступа \autocite[сс. 15-18]{Skakun}. 

Вышеприведенные понятия в большей степени связаны с организацией защиты конфиденциальных данных. Наряду с защитой конфиденциальных данных в понятие безопасности данных входит также обеспечение целостности и доступности данных \autocite[сс. 15-18]{Skakun}. В основе обеспечения безопасности лежит управление этими тремя ключевыми свойствами данных:
\begin{itemize}
    \item \textbf{Конфиденциальность} - это свойство информации быть известной только допущенным и прошедшим проверку субъектам системы \autocite[сс. 15-18]{Skakun}. Это гарантия того, что данные не будут раскрыты неавторизованным лицам.
    \item \textbf{Целостность данных} - свойство данных сохранять точность и непротиворечивость независимо от внесенных изменений. Зависит от способности информационной системы обеспечить неизменность данных в условиях случайного и (или) преднамеренного искажения (разрушения) \autocite[сс. 15-18]{Skakun}.
    \item \textbf{Доступность данных} - возможность реализации беспрепятственного доступа к информации субъектов, имеющих на это надлежащие полномочия \autocite[сс. 15-18]{Skakun}. Система должна быть доступна для авторизованных пользователей тогда, когда это необходимо.
\end{itemize}

Понимание этих основополагающих понятий является ключом к анализу угроз, который мы рассмотрим в следующем разделе, и к построению моделей безопасности, которые будут детально изучены в главе \ref{chap:theoretical_foundations}.

\subsection{Угрозы безопасности БД: общие и специфичные}
Интуитивное понимание угрозы безопасности можно сформулировать как нарушение великолепной тройки: конфиденциальности, целостности и доступности. 
\begin{grayquote}
\textbf{Угроза информационной безопасности} - это осуществляемое или потенциально осуществимое воздействие на компьютерную систему, которое прямо или косвенно может нанести ущерб безопасности информации \autocite[с. 19]{Skakun}.
\end{grayquote}
По источнику воздействия на КС угрозы разделяются на внутренние и внешние \autocite{Ytebov2008}.

Внешними дестабилизирующими факторами, создающими угрозы безопасности функционированию систем КС, являются:
\begin{itemize}
	\item умышленные, деструктивные действия лиц с целью искажения, уничтожения или хищения программ, данных и документов системы, причиной которых являются нарушения информационной безопасности защищаемого объекта
	\item искажения в каналах передачи информации, поступающей от внешних источников, циркулирующих в системе и передаваемой потребителям, а также недопустимые значения и изменения характеристик потоков информации из внешней среды и внутри системы~\label{pon:pot}
	\item сбои и отказы в аппаратуре вычислительных средств
	\item вирусы и иные деструктивные программные элементы, распространяемые с использованием систем телекоммуникаций, обеспечивающих связь с внешней средой или внутренние коммуникации распределенной системы баз данных
	\item изменения состава и конфигурации комплекса взаимодействующей аппаратуры системы за пределы, проверенные при тестировании или сертификации системы
\end{itemize}

Внутренними источниками угроз безопасности КС являются:
\begin{itemize}
	\item ошибки проектирования КС
	\item ошибки при определении условий и параметров функционирования внешней среды, в которой предстоит использовать информационную систему и, в частности, программно-аппаратные средства защиты данных
	\item ошибки и несанкционированные действия пользователей, административного и обслуживающего персонала в процессе эксплуатации системы
	\item недостаточная эффективность используемых методов и средств обеспечения информационной безопасности в штатных или особых условиях эксплуатации системы
\end{itemize}

Наиболее опасными являются угрозы, вызванные человеческой деятельностью, именно им уделяется особое внимание.

Выше перечислены угрозы на всех уровнях КС~\label{pon:urovs}. Под уровнями будем подразумевать следующее разбиение:
\begin{itemize}
	\item На уровне сети
	\begin{itemize}
		\item Activex-объект
		\item Интерфейсы: OLE DB, ADO, ODBC, JDBC
		\item Протоколы: TCP/IP, IPX/SPX, Named Pipes, Multiprotocol
		\item Рабочие станции
		\item Серверы
		\item Маршрут
		\item URL
	\end{itemize}
	\item На уровне ОС
	\begin{itemize}
		\item Аппаратное обеспечение
		\item Программное обеспечение
		\item Файлы базы данных
		\item Файлы журнала транзакций
		\item Файлы резервного копирования
		\item Transact-SQL, PLSQL
		\item Службы: MSSQLServer, SQLServerАgent, TNSListener и т. д.
	\end{itemize}
	\item На уровне БД
	\begin{itemize}
		\item Пользователи
		\item Роли
		\item Роли приложения
		\item Диаграммы
		\item Представления
		\item Таблицы
		\item Хранимые процедуры
		\item Определения по умолчанию
		\item Правила
		\item Функции
		\item Тип данных
	\end{itemize}
\end{itemize}

\subsubsection{Специфичные угрозы для СУБД}
Помимо общих угроз, таких как «Отказ в обслуживании» (DoS) или подбор паролей, существуют специфические для баз данных векторы атак. Их можно классифицировать в соответствии с нарушаемым свойством триады безопасности \autocite{Ytebov2008, bdufstec}:

\begin{itemize}
	\item \textbf{Угрозы конфиденциальности} (несанкционированный доступ к информации)~\label{ugr:conf}:
	\begin{enumerate}
		\item \textbf{Инъекция SQL (SQL Injection).} Самая известная уязвимость, при которой злоумышленник внедряет вредоносный SQL-код в запрос, обходя логику приложения. Это позволяет читать, изменять или удалять данные, обходя механизмы авторизации.
		\item \textbf{Логический вывод.} Используя доступ к разрешенным данным и зная о функциональных зависимостях или ограничениях целостности, злоумышленник может дедуктивно восстановить скрытую информацию.
		\item \textbf{Атака через оператор UPDATE.} В некоторых системах пользователь без прав на чтение (SELECT) мог выполнять UPDATE со сложным логическим условием. Анализируя количество измененных строк, можно было сделать выводы о наличии или отсутствии определенных данных.
		\item \textbf{Маскарад.} Выполнение действий от имени другого пользователя, обладающего большими полномочиями, после кражи его учетных данных.
	\end{enumerate}
	\item \textbf{Угрозы целостности} (несанкционированное изменение данных)~\label{ugr:cel}:
	\begin{enumerate}
		\item \textbf{Прямая модификация данных.} Пользователь с избыточными привилегиями (UPDATE, INSERT, DELETE) может повредить или исказить данные во всей таблице.
        \item \textbf{Нарушение бизнес-логики.} Обход проверок, реализованных на уровне приложения, и запись в базу некорректных с точки зрения бизнес-процессов данных.
	\end{enumerate}
	\item \textbf{Угрозы доступности} (создание невозможности доступа к данным):
	\begin{enumerate}
		\item \textbf{Манипуляция с ключами.} Создание записей с "занятыми" первичными ключами, что мешает добавлению новых легитимных данных, или создание "висячих" дочерних записей, которые препятствуют удалению родительских.
		\item \textbf{Блокировка записей (Locking).} Злоумышленник может на долгое время заблокировать важные таблицы или строки, сделав их недоступными для обновления другими пользователями.
		\item \textbf{Перегрузка системы.} Выполнение ресурсоемких запросов (например, декартово произведение больших таблиц), которые потребляют все ресурсы сервера и замедляют или полностью останавливают обработку запросов от других пользователей.
		\item \textbf{Атака <<троянский конь>>.} Запуск пользователем программы, которая под видом легитимной выполняет разрушительные действия с базой данных.
	\end{enumerate}
\end{itemize}

\subsection{Требования безопасности БД}
Требования к безопасности баз данных можно условно разделить на несколько уровней: от общих концептуальных принципов до конкретных технических и нормативных предписаний. 

\subsubsection{Общие требования}
К этой категории относятся фундаментальные принципы, которые должна обеспечивать любая защищенная система, работающая с ценными данными \autocite{LAPA, Pirogov2009}:
\begin{itemize}
    \item \textbf{Функционирование в доверенной среде.} Вся инфраструктура, включая аппаратное обеспечение, операционную систему и сетевое окружение, должна быть настроена и защищена таким образом, чтобы создавать безопасную среду для работы СУБД.
    \item \textbf{Организация физической безопасности.} Доступ к серверам, на которых хранятся данные, должен быть физически ограничен. Это требование не отличается от общих норм физической безопасности для любого серверного оборудования.
    \item \textbf{Безопасность пользовательского ПО.} Приложения, работающие с базой данных, должны иметь безопасные интерфейсы и механизмы доступа к данным, чтобы не стать вектором атаки на СУБД.
\end{itemize}

\subsubsection{Технические требования к СУБД}
Этот уровень включает в себя более специфические требования к самой системе управления базами данных \autocite{LAPA, Pirogov2009}:
\begin{itemize}
    \item \textbf{Организация безопасной и актуальной настройки СУБД.} Это требование включает в себя общие задачи обеспечения безопасности, такие как своевременная установка обновлений, отключение неиспользуемых функций и применение эффективной политики паролей.
    \item \textbf{Безопасная организация и работа с данными.} Вопрос организации данных и управления ими является ключевым в системах хранения информации. В эту область входят задачи организации данных с контролем целостности и другие, специфичные для СУБД проблемы безопасности. Фактически эта задача включает в себя основной объем зависящих от данных уязвимостей и защиты от них.
\end{itemize}

\subsubsection{Нормативно-правовые требования в Российской Федерации}
В России требования к защите информации в значительной степени регулируются нормативными актами Федеральной службы по техническому и экспортному контролю (ФСТЭК). Для государственных информационных систем (ГИС) и систем, обрабатывающих персональные данные, ключевым является \textbf{Приказ ФСТЭК России №17} \autocite{fstec17}. Для значимых объектов критической информационной инфраструктуры (КИИ) — \textbf{Приказ ФСТЭК России №239} \autocite{FSTEKOBKIS}.

Эти документы определяют многоуровневую структуру защиты и предписывают реализацию конкретных организационных и технических мер. В контексте автоматизированных систем управления, к которым относятся и СУБД, выделяются следующие объекты защиты:
\begin{enumerate}
	\item информация (данные о параметрах, командная, технологическая информация);
	\item программно-аппаратные средства (серверы, рабочие места, сетевое оборудование);
	\item программные средства (общесистемное и прикладное ПО);
	\item средства защиты информации.
\end{enumerate}

Принимаемые меры защиты, согласно этим документам, должны:
\begin{itemize}
    \item \textbf{обеспечивать доступность, целостность и конфиденциальность} обрабатываемой информации;
    \item \textbf{соотноситься с мерами по промышленной, физической и иным видам безопасности};
    \item \textbf{не оказывать отрицательного влияния} на штатный режим функционирования системы.
\end{itemize}

В зависимости от класса защищенности системы, приказы ФСТЭК предписывают реализацию до 18 групп мер защиты, среди которых:
\begin{itemize}
    \item идентификация и аутентификация (ИАФ);
    \item управление доступом (УПД);
    \item ограничение программной среды (ОПС);
    \item аудит безопасности (АУД);
    \item антивирусная защита (АВЗ);
    \item предотвращение вторжений (СОВ);
    \item обеспечение целостности (ОЦЛ) и доступности (ОДТ).
\end{itemize}
Таким образом, нормативные требования в РФ конкретизируют общие принципы безопасности, превращая их в набор обязательных для внедрения технических и организационных мер.

\subsection{Защита от несанкционированного доступа}
Защита от несанкционированного доступа является краеугольным камнем в обеспечении \textbf{конфиденциальности} данных. Как было показано в разделе \ref{ugr:conf}, существует множество способов получить несанкционированный доступ к информации. Соответственно, система защиты должна предоставлять комплекс механизмов, противодействующих этим угрозам.

Согласно \autocite[с. 11]{Skakun}, система для защиты данных от НСД должна обеспечивать:
\begin{itemize}
	\item поддержку ограничений прав и полномочий доступа, определяемых информационной политикой;
	\item защиту от вредоносных действий пользователей, направленных на повреждение или получение конфиденциальных данных.
\end{itemize}

Для реализации этих задач применяются как компьютерные, так и организационные (некомпьютерные) средства защиты \autocite[сс. 12-14]{Skakun}.

\subsubsection{Компьютерные средства защиты}
\begin{itemize}
	\item \textbf{Идентификация и аутентификация.} Это первая линия обороны. Система должна однозначно определять, кто пытается получить доступ. Простейший пример — парольная защита. Более надежным вариантом является многофакторная аутентификация или использование SSL-сертификатов \autocite{MicrosoftLearnSQLserverPerm}.

	\item \textbf{Авторизация и управление доступом.} После того как пользователь аутентифицирован, система должна определить, что именно ему разрешено делать. Это достигается через:
	\begin{itemize}
		\item \textbf{Разграничение прав доступа:} Пользователям предоставляются только необходимые им привилегии на выполнение операций (SELECT, INSERT, UPDATE, DELETE).
		\item \textbf{Представления (Views):} Мощный механизм, позволяющий скрыть от пользователя определенные строки или столбцы таблицы. Пользователь работает с представлением, не имея прямого доступа к базовым таблицам, что предотвращает утечку данных и атаки на основе логического вывода \autocite[с. 12]{Skakun}.
		\item \textbf{Хранимые процедуры и функции:} Инкапсуляция бизнес-логики в хранимых процедурах позволяет предоставить пользователю доступ не к таблицам напрямую, а к процедуре, которая выполняет строго определенные действия. Это обеспечивает более высокий уровень контроля.
	\end{itemize}

	\item \textbf{Защита данных на уровне хранения:}
	\begin{itemize}
		\item \textbf{Шифрование (Encryption):} Шифрование данных "в состоянии покоя" (at rest) делает их нечитаемыми для любого, кто получит прямой доступ к файлам базы данных, минуя СУБД. Уязвимость этого метода заключается в управлении ключами шифрования \autocite{oracledbdoc3}.
	\end{itemize}
	
	\item \textbf{Мониторинг и обеспечение надежности:}
	\begin{itemize}
		\item \textbf{Аудит (Auditing):} Журналирование всех или наиболее важных операций с данными. Анализ журналов аудита позволяет выявлять подозрительную активность и расследовать инциденты.
		\item \textbf{Резервное копирование и восстановление:} Хотя это в первую очередь механизм обеспечения доступности, он также защищает от несанкционированного удаления или порчи данных.
	\end{itemize}
\end{itemize}

\subsubsection{Некомпьютерные средства защиты}
Технические средства не могут быть эффективны без организационной поддержки:
\begin{itemize}
	\item \textbf{Управление персоналом и физический доступ:} Контроль доступа в серверные помещения, четкое распределение обязанностей и ответственности между сотрудниками.
	\item \textbf{Обеспечение защиты помещений} с помощью различных охранных систем.
	\item \textbf{Заключение гарантийных соглашений и контрактов} на обслуживание оборудования и программного обеспечения систем безопасности.
\end{itemize}
Документы, регламентирующие меры безопасности, должны четко определять область их применения, ответственность сотрудников и дисциплинарные меры за нарушение установленных правил. Таким образом, для минимизации риска несанкционированного доступа необходима реализация комплекса нормативных, организационных и технических мер.

\subsection{Управление доступом и привилегии}
После того как система установила личность пользователя (аутентификация), наступает этап авторизации — определение того, какие действия этому пользователю разрешено выполнять. В основе управления доступом лежит \textbf{принцип минимальных привилегий} (Principle of Least Privilege, PoLP) \autocite{oracledbdoc3}. Его суть заключается в том, что любому субъекту системы (пользователю или процессу) должны предоставляться только те права, которые минимально необходимы для выполнения его задач. Этот принцип минимизирует потенциальный ущерб от случайных ошибок или злонамеренных действий.

\begin{grayquote}
	\textbf{Привилегия} – это разрешение на выполнение в системе определенного действия. Не имея соответствующей привилегии, пользователь не может получить доступ к данным или выполнить какое-либо действие \autocite{Smirnov2007}.
\end{grayquote}

В СУБД все привилегии можно разделить на два основных класса: системные привилегии и привилегии доступа к объектам \autocite{MicrosoftLearnSQLserverPerm}.

\begin{itemize}
    \item \textbf{Системные привилегии} дают пользователю право на выполнение операций в масштабе всей базы данных или системы. Эти привилегии обычно требуются администраторам.
    \begin{itemize}
        \item \textit{Пример:} Привилегия `CREATE TABLE` позволяет пользователю создавать новые таблицы, а `ALTER TABLESPACE` — изменять табличные пространства.
    \end{itemize}

    \item \textbf{Привилегии доступа к объекту} предоставляют право на выполнение определенной операции над конкретным объектом базы данных (таблицей, представлением, хранимой процедурой).
    \begin{itemize}
        \item \textit{Пример:} Привилегия `SELECT` на таблицу `Сотрудники` позволяет пользователю читать данные из этой таблицы, но не изменять их и не обращаться к другим таблицам.
    \end{itemize}
\end{itemize}

Управление привилегиями напрямую является сложной задачей. Поэтому в современных СУБД широко применяется \textbf{ролевая модель доступа (RBAC)}, где привилегии группируются в роли (например, <<Бухгалтер>>, <<Аналитик>>), а уже роли назначаются пользователям. Этот подход, который будет подробнее рассмотрен в главе 2, значительно упрощает администрирование прав доступа.

\subsection{Целостность БД}
Под понятием целостности данных понимается их точность, непротиворечивость и согласованность в течение всего жизненного цикла \autocite[с. 18]{Skakun}. Важно различать целостность (consistency) и достоверность (accuracy) данных. Достоверность означает соответствие данных реальному миру, тогда как целостность гарантирует, что данные в базе соответствуют заданным правилам и ограничениям, исключая логически невозможные состояния \autocite{ElmasriNavathe}.

Контроль целостности — это одна из ключевых функций СУБД, которая обеспечивает неизменность данных при случайных или преднамеренных искажениях. В реляционных базах данных выделяют несколько основных видов логической целостности \autocite{Silberschatz}:

\begin{itemize}
    \item \textbf{Целостность сущностей (Entity Integrity).} Гарантирует, что каждая строка в таблице является уникальной. Этот вид целостности обеспечивается с помощью \textbf{первичного ключа (PRIMARY KEY)}, который не может содержать повторяющихся или NULL-значений.
    
    \item \textbf{Ссылочная целостность (Referential Integrity).} Обеспечивает согласованность связей между таблицами. Если в одной таблице есть значение, которое ссылается на запись в другой таблице, то эта запись должна существовать. Реализуется с помощью \textbf{внешних ключей (FOREIGN KEY)}.
    
    \item \textbf{Целостность домена (Domain Integrity).} Ограничивает тип, формат и диапазон допустимых значений для столбца. Этот вид целостности обеспечивается через:
    \begin{itemize}
        \item типы данных (например, `INTEGER`, `DATE`);
        \item ограничение `NOT NULL`, запрещающее пустые значения;
        \item ограничение `UNIQUE`, гарантирующее уникальность значений в столбце;
        \item ограничение `CHECK`, задающее произвольное логическое условие для значений.
    \end{itemize}
    
    \item \textbf{Пользовательская целостность (User-Defined Integrity).} Включает специфические бизнес-правила, которые не могут быть выражены стандартными ограничениями. Такие правила обычно реализуются с помощью триггеров.
\end{itemize}

Мы уже обсуждали основные угрозы целостности в разделе \ref{ugr:cel}. Для их предотвращения и применяются перечисленные механизмы. Теоретической основой для реализации более сложных политик целостности служат такие модели, как модель \textbf{Кларка-Вильсона} и модель \textbf{Биба}, которые будут рассмотрены в главе \ref{sec:multilevel_models}.

\subsection{Аудит безопасности}

Аудит может быть интерпретирован различными способами. Во-первых, аудит может рассматриваться как непрерывный процесс, то есть, фактически, как мониторинг. Этот подход тщательно анализируется в главе 13 <<Аудит систем баз данных>> \autocite{Smirnov2007}.
В рамках данного подраздела мы обсудим альтернативное понимание аудита, рассматривая его как конечный процесс. Данный подразрадел является переводом и резюме 9 главы книги <<Database Security>> \autocite{DatabaseSecurity}.

\subsubsection{Определение}

Аудит информационной безопасности информационных систем — это процесс оценки системы защиты информации на предмет соответствия стандартам и требованиям безопасности, а также выявления уязвимостей и возможных угроз безопасности.

\subsubsection{Цели проведения аудита}

Основной целью проведения аудита информационной безопасности является выявление уязвимостей в системе защиты информации и предотвращение возможных угроз безопасности. Кроме того, аудит также позволяет определить эффективность системы защиты, а также проверить соответствие информационных систем законодательству и стандартам безопасности.

\subsubsection{Процесс проведения аудита}

Процесс проведения аудита обычно включает 3 этапа:
\begin{enumerate}
	\item Подготовка и планирование
	\item Аудит
	\item Отчет
\end{enumerate}

\paragraph{1. Подготовка и планирование.}

На этом этапе формируется команда, которая будет проводить аудит, определяется область аудита, составляется план и график проведения аудита.

Область аудита — это система, на которой будет сосредоточен аудит. Определяются приоритетные активы и периметр аудита. Связанные активы изучаются и классифицируются как находящиеся в периметре аудита или за его пределами. Определение области аудита требует от аудитора четкого понимания устройста инфраструктуры и организационной структуры. Список активов должен быть составлен путем анализа документации, архитектуры системы и организационных иерархий. Должны быть включены как материальные (например, компьютеры, серверы, принтеры, отдельные лица), так и нематериальные (например, данные, электронная почта, веб-приложения, пароли) элементы. Угрозы этим активам должны быть идентифицированы, а приоритизация осуществляется с использованием результатов анализа рисков. Хорошей практикой является проверка результатов предыдущего аудита безопасности, чтобы понять, какие приоритеты были расставлены в прошлом.

После определения области аудита можно четко определить цели аудита и составить план. План составляется с учетом уже собранной информации, а также с учетом даты и времени проведения аудита, стратегии резервного копирования и влияния процесса на ежедневные операции.

Из-за множества компонентов системы (например, файлов, серверов, приложений, данных) и методов (например, политик, межсетевых экранов, биометрии, шифрования), задействованных в обеспечении безопасности, практически невозможно провести аудит всей системы одновременно. Поэтому в разное время года для организации планируются несколько небольших аудитов безопасности, каждый из которых фокусируется только на определенной области. Обычная разбивка областей аудита безопасности включает в себя физическую безопасность, безопасность ОС, веб-приложений, веб-серверов, серверов БД, сетевого оборудования, политик и процедур.

График проведения аудита может сильно измениться, если резко меняются приоритеты. Например, в таблице на Рис. \ref{fig:Schedule_audit} представлен возможный график аудита безопасности для организации. В первом столбце таблицы отображается исходный график аудита, а во втором столбце отображается тот же график после внесения корректировок из-за обнаружения уязвимости (возможной SQL-инъекции).

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.8\textwidth]{assets/Schedule_audit}
    \caption{Пример графика проведения аудита}
	\label{fig:Schedule_audit}
\end{figure}

\paragraph{2. Аудит.}

На этом этапе подробный план аудита безопасности, составленный на предыдущем этапе, приводится в действие. Конкретные действия во время проведения аудита зависят от множества факторов, включая тип аудита, область аудита и организацию. Очевидно, что аудит, предназначенный для проверки физической безопасности, будет включать в себя совершенно иные действия, чем аудит, предназначенный для проверки администрирования СУБД. На Рис.\ref{fig:Common_actions_audit} в таблице показан список действий, которые обычно выполняются в процессе аудита для разных типов систем.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.8\textwidth]{assets/Common_actions_audit}
    \caption{Пример обычных действий при проведении аудита}
	\label{fig:Common_actions_audit}
\end{figure}

\paragraph{3. Отчет.}

Заключительным этапом процесса аудита безопасности является подведение итогов, на котором аудитор или комитет аудиторов устно и письменно сообщает о результатах аудита.

Во всех аудиторских отчетах можно обнаружить некоторые важные общие черты, включающие исходную информацию, определенную область аудита, план и цель аудита, ключевые выводы, используемую для риск-аналитики методологию, рекомендации по устранению найденных уязвимостей.

\subsubsection{Процесс проведения аудита БД}

\paragraph{Подготовка и планирование аудита БД.}

Подготовка к аудиту безопасности БД требует, чтобы аудитор собрал как можно больше информации об инфраструктуре БД для четкого определения периметра аудита. Периметр должен включать подробную информацию о людях, данных, технологиях и документах, которые будут играть роль в рамках конкретного аудита. На Рис. \ref{fig:DB_audit_perimeter} представлен пример периметра аудита БД.

Сбор информации включает в себя консультацию с администраторами БД, изучение схем баз данных, архитектуру сети, политик и процедур, связанных с БД. Часто организации имеют несколько СУБД, поэтому необходимо принять решение, сколько систем будет проверяться.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.8\textwidth]{assets/DB_audit_perimeter}
    \caption{Пример периметра аудита БД}
	\label{fig:DB_audit_perimeter}
\end{figure}

На этом этапе также необходимо получить понимание функциональности, назначения и структуры всех используемых СУБД. Важна такая информация, как вендор СУБД, ОС функционирования СУБД, стратегия резервного копирования. Необходимо провести анализ данных на предмет связи с организационной иерархией, чтобы понять потребности сотрудников в хранении данных и манипулировании ими.

Анализ рисков и угроз является еще одним важным этапом планирования аудита БД, поскольку он помогает определить приоритетный список действий, который можно использовать в качестве отправной точки для аудита. Чтобы гарантировать, что были приняты все меры для защиты БД и учтены все риски, необходимо рассматривать всю инфраструктуру БД, в том числе сетевую.

Аудит БД может выполняться одним из двух способов. Аудитор может сначала сосредоточиться на компонентах, связанных с БД (например, веб-приложениях, веб-серверах, middleware, скриптах), прежде чем переходить к БД, или аудит может начаться с БД, и впоследствии проводится проверка связанных компонентов.

\paragraph{Аудит БД.}

Из-за большого количества ресурсов, необходимых для проверки всей инфрастуктуры БД, аудит обычно проводится частями, фокусируясь на конкретных функциях или компонентах. Эти части могут включать обслуживание серверов, администрирование учетных записей, контроль доступа, привилегии доступа к данным, пароли, шифрование, активность пользователей.

\paragraph{Обслуживание серверов.}

Аудит обслуживания сервера включает проверку стратегий резервного копирования, контроля обновлений и версий ПО, управления ресурсами и обновлениями оборудования. Ниже приведен список примеров аудиторских проверок:

\begin{enumerate}
	\item Установлены последние патчи безопасности СУБД
	\item Установлены последние критические обновления СУБД
	\item Используемая версия СУБД поддерживается
	\item Существует и используется процедура обновления СУБД
	\item Существует и применяется политика резервного копирования, включающая аварийное восстановление
	\item Существует и используется процедура проверки резервных копий
\end{enumerate}

\paragraph{Администрирование учетных записей.}

Аудит администрирования учетных записей включает проверку того, как администратор управляет учетными записями пользователей, а именно: создание, удаление учетных записей пользователей; применение политик безопасности; назначение групп, ролей и привилегий. Примеры аудиторских проверок:

\begin{enumerate}
	\item Различные роли администраторов четко определены
	\item Учетные записи администраторов распределяются согласно политике
	\item Неактивные или ненужные учетные записи пользователей удаляются
	\item Общие учетные записи не используются
	\item Учетные записи по умолчанию отключены или удалены
\end{enumerate}

\paragraph{Контроль доступа.}

Контроль доступа включает отслеживание доступа пользователей к БД. Контроль доступа необходим для обеспечения конфиденциальности, целостности и доступности СУБД. Примеры аудиторских проверок:

\begin{enumerate}
	\item Только доверенные IP-адреса могут получить доступ к базе данных
	\item Доступ к конфиденциальным данным имеют только те, кому они необходимы
	\item Администраторы не имеют возможности удаленно вносить изменения в БД без дополнительной аутентификации
	\item Доступ к резервным копиям и аварийному восстановлению разрешен только администраторам
\end{enumerate}

\paragraph{Привилегии доступа к данным.}

Обеспечение соответствия привилегий доступа во время аудита — трудоемкая задача, которая требует сотрудничества с сетевым администратором. Примеры аудиторских проверок:

\begin{enumerate}
	\item PUBLIC удален из системы
	\item Неявное предоставление привилегий тщательно рассматривается
	\item Используется принцип наименьших привилегий
	\item Привилегии учетной записи в операционной системе ограничены
\end{enumerate}

\paragraph{Пароли.}

Надежные пароли имеют решающее значение в доверенной среде, поскольку они представляют собой первую линию защиты, с которой столкнутся злоумышленники. Большинство СУБД можно настроить так, чтобы пароли автоматически соответствовали определенной политике. Аудит управления паролями включает проверку написанной политики, конфигурации сервера и учетных записей пользователей по умолчанию. Примеры аудиторских проверок:

\begin{enumerate}
	\item Опции управления паролями включены в СУБД
	\item Парольная политика включает спецификации для неудачных входов в систему, устаревания, сложности, истории, срока действия и содержимого
	\item Пароли по умолчанию должны быть изменены
	\item По возможности пароли не хранятся в БД
	\item Пароли шифруются с использованием стойкого шифрования, если они хранятся в БД
\end{enumerate}

\paragraph{Шифрование.}

Шифрование должно быть проверено как для хранящихся, так и для перемещаемых данных по БД. Примеры аудиторских проверок:

\begin{enumerate}
	\item Хранимые и перемещаемые данные шифруются с использованием надежных методов шифрования
	\item Для шифрования данных используются симметричные ключи
	\item Шифрование настроено точно согласно политике
	\item Чувствительные данные задокументированы и помечены как таковые
\end{enumerate}

\paragraph{Активность пользователей.}

Должен быть настроен мониторинг действий пользователей, работающих с СУБД. Примеры аудиторских проверок:

\begin{enumerate}
	\item Неудачные входы отслеживаются
	\item Неудачные запросы отслеживаются
	\item Изменения метаданных отслеживаются
\end{enumerate}

\paragraph{Отчет об аудите БД.}

Подготовка и презентация отчета об аудите БД совпадает с описанным ранее общим этапом аудита безопасности.

\clearpage

\subsection{Модели и принципы многоуровневой защиты}\label{sec:multilevel_models}
Как уже было сказано, безопасность системы зависит от защиты на всех уровнях: от сетевой инфраструктуры до соответствия нормативным требованиям. Анализ успешных решений в области информационной безопасности позволяет сформулировать несколько ключевых принципов, которыми следует руководствоваться при проектировании систем защиты \autocite{Smirnov2007}:
\begin{itemize}
	\item \textbf{Экономическая оправданность механизмов защиты.} Проект должен обеспечивать необходимый уровень безопасности, оставаясь в рамках бюджета.
	\item \textbf{Открытое проектирование.} Безопасность системы не должна зависеть от секретности ее алгоритмов, а только от секретности ключей.
	\item \textbf{Распределение полномочий.} Для критически важных операций следует использовать многокомпонентные схемы доступа, требующие участия нескольких субъектов.
	\item \textbf{Принцип минимальных привилегий.} Пользователи и администраторы должны обладать только теми правами, которые необходимы для выполнения их задач.
	\item \textbf{Управляемость при отказах и сбоях.} Система должна быть спроектирована с учетом возможных сбоев и иметь четкие процедуры восстановления.
	\item \textbf{Психологическая приемлемость.} Средства защиты должны быть интуитивно понятными и не создавать излишних сложностей для пользователей.
\end{itemize}

Реализация этих принципов на практике достигается с помощью формальных \textbf{моделей контроля доступа}. Эти модели определяют, как система принимает решения о предоставлении или запрете доступа субъектов к объектам.

\subsubsection{Модели контроля доступа}
Существует три классические модели контроля доступа, которые служат основой для построения систем разграничения доступа в СУБД \autocite{Tanenbaum}:
\begin{itemize}
    \item \textbf{Дискреционная (избирательная) модель доступа (Discretionary Access Control, DAC).} В этой модели владелец объекта (например, создатель таблицы) сам определяет, кому и какие права доступа к этому объекту предоставить. Это гибкая, но менее централизованная модель.
    \item \textbf{Мандатная модель доступа (Mandatory Access Control, MAC).} Доступ определяется на основе сопоставления меток безопасности, присвоенных субъектам (уровень допуска) и объектам (уровень конфиденциальности). Правила задаются централизованно и не могут быть изменены владельцами объектов. Именно эта модель реализует классическую многоуровневую безопасность (Multilevel Security, MLS).
    \item \textbf{Ролевая модель доступа (Role-Based Access Control, RBAC).} Права доступа группируются в роли в соответствии с должностными обязанностями в организации (например, «бухгалтер», «менеджер»). Пользователям назначаются роли, и они получают все привилегии, связанные с этой ролью.
\end{itemize}
Каждая из этих моделей имеет свои преимущества и недостатки и будет подробно рассмотрена в главе \ref{chap:theoretical_foundations}.

\subsection{Процедуры и формализация контроля доступа}
Управление доступом представляет собой стратегию обеспечения безопасности информации, осуществляемую через контроль и регулирование использования ресурсов системы \autocite[с. 36]{Skakun}. Идейно этот процесс распадается на два ключевых вопроса: \textit{кому} и \textbf{что} мы будем разрешать?

\subsubsection{Кому: Идентификация, аутентификация и авторизация}
Получение доступа к ресурсам информационной системы предусматривает выполнение трех последовательных процедур:
\begin{enumerate}
	\item \textbf{Идентификация.} Процесс, в ходе которого субъект называет себя системе, предъявляя свой уникальный идентификатор (например, логин).
	\item \textbf{Аутентификация.} Процедура проверки подлинности субъекта, в ходе которой он доказывает, что является тем, за кого себя выдает (например, вводя пароль или используя биометрические данные).
	\item \textbf{Авторизация.} Процесс определения и предоставления субъекту, успешно прошедшему аутентификацию, конкретного набора прав и привилегий для доступа к объектам системы.
\end{enumerate}
Эти три процедуры являются обязательным элементом любой защищенной ИС, реализуя первый рубеж защиты информации.

\subsubsection{Что: Права доступа и матрица доступа}
После того как субъект авторизован, система должна знать, какие именно действия ("что") ему разрешено выполнять с различными объектами. Эти разрешения формализуются в виде прав доступа. Классическим способом теоретического представления этих прав является \textbf{матрица доступа} \autocite{Tanenbaum}.

Матрица доступа — это абстрактная модель, представляющая собой таблицу, где:
\begin{itemize}
    \item \textbf{строки} соответствуют субъектам (пользователям, процессам);
    \item \textbf{столбцы} соответствуют объектам (файлам, таблицам, записям);
    \item \textbf{ячейки} на пересечении строки субъекта $S$ и столбца объекта $O$ содержат список прав (например, `read`, `write`, `execute`), которые субъект $S$ имеет по отношению к объекту $O$.
\end{itemize}

На практике матрица доступа редко реализуется в виде единой таблицы из-за ее разреженности и большого размера. Вместо этого используются более эффективные методы ее хранения:
\begin{itemize}
    \item \textbf{Списки контроля доступа (Access Control Lists, ACL),} хранящиеся с объектами (поколоночное хранение матрицы).
    \item \textbf{Списки возможностей (Capability Lists),} хранящиеся с субъектами (построчное хранение матрицы).
\end{itemize}
Тем не менее, матрица доступа остается фундаментальной концепцией, которая наглядно формализует политику безопасности, определяя, "что" именно может делать "кто" в системе.

\clearpage
